<div id="heading"></div>
<div id="hd-border"></div>
<div id="NavTabs"></div>
<script>
  window.MK = {
    LESSON : <%= @lesson_api.to_json.html_safe %>,
    USER : <%= current_user.to_api.to_json.html_safe %>,
    CSRFTOKEN : '<%= form_authenticity_token %>'
  };

  var tabs = [];
  tabs.push({
      name: 'Materials',
      content : Materials,
      async : '/lessons/' + MK.LESSON.id + '/materials'
  });

  switch(MK.USER.type) {
      case 'Student':
          tabs.push({
              name: 'My Feedback',
              content : Feedback,
              async : '/students/' + MK.USER.id + '/lessons/' + MK.LESSON.id + '/feedback'
          });
          break;
      case 'Teacher':
          tabs.push({
              name: 'Feedback Data',
              content : FeedbackData,
              async : '/lessons/' + MK.LESSON.id + '/feedbacks'
          });
          break;
  };

  React.render(Heading({
                course_name: MK.LESSON.course_name,
                lesson: MK.LESSON
              }), document.getElementById('heading'));
  MK.Nav = React.render(NavTabs(), document.getElementById('NavTabs'));
  $.ajax({
      url: tabs[0].async,
      dataType: "JSON"
  })
  .done(function(rsp) {
      rsp.tabs = tabs;
      rsp.active = 0;
      MK.Nav.setState(rsp);
  });
</script>
