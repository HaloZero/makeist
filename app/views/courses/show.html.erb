<div id="hd-border"></div>
<div id="NavTabs"></div>
<script>
    window.MK = {
        COURSE : <%= @course.to_api.to_json.html_safe %>,
        USER : <%= current_user.to_api.to_json.html_safe %>,
        CSRFTOKEN : '<%= form_authenticity_token %>'
    };

    var lesson, tabs = [];
  <% if @lesson %>
    lesson = <%= @lesson.to_api.to_json.html_safe %>
  <% end %>

    tabs.push({
        name: 'Lessons',
        content: Lessons,
        async : function() {
            return {
                lessons: MK.COURSE.lessons,
                lesson: lesson || MK.COURSE.lessons[0]
            }
        }
    });
    if(MK.COURSE.calendar_embed) {
        tabs.push({
            name: 'Calendar',
            content: Calendar,
            async: function() {
                return { embed_url: MK.COURSE.calendar_embed }
            }
        });
    }
    tabs.push({
        name: 'Members',
        content: Members,
        async: '/courses/' + MK.COURSE.id + '/students'
    });
    tabs.push({
        name: 'Attendance',
        content: Attendances,
        async: '/courses/' + MK.COURSE.id + '/attendances'
    });

    MK.Nav = React.render(NavTabs(), document.getElementById('NavTabs'));
    MK.Nav.setState({
        tabs: tabs,
        courseName: MK.COURSE.name,
        content: {
            lessons: MK.COURSE.lessons,
            lesson: lesson || MK.COURSE.lessons[0]
        }
    });
</script>
